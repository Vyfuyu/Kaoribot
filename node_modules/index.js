const express = require('express');
const bodyParser = require('body-parser'); 
const apiTaoAnhRouter = require('./routes/apitaoanh'); 

const app = express();
// ❗ CONFIG QUAN TRỌNG VCL CHO RAILWAY ❗
// Railway sẽ gán cổng ngẫu nhiên, nên phải lấy từ process.env.PORT
const PORT = process.env.PORT || 3000; 

// Setup middleware
app.use(bodyParser.json()); // Để đọc được body JSON

// GẮN ROUTER VÀO PREFIX CHÍNH
// Mọi request POST tới /apitaoanh sẽ chạy qua logic phân luồng
app.use('/apitaoanh', apiTaoAnhRouter); 

app.get('/', (req, res) => {
    res.send('API tạo ảnh bẩn bựa đã chạy ổn rồi bro :))');
});

app.listen(PORT, () => {
    console.log(`Server chạy vù vù ở cổng ${PORT}`);
});
